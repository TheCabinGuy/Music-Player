{"ast":null,"code":"var _jsxFileName = \"/Users/moorea6/Synoptic Project/Music-Player/client/src/components/musicPlayer/MusicPlayer.tsx\";\nimport React, { createRef, useEffect, useRef } from \"react\";\nimport { connect } from \"react-redux\";\nimport { REPEAT_ACTIONS, setCurrentTime, setDuration, toggleSeeking, toggleSongPlaying, nextSong } from \"../../store/slice\";\n\nconst MusicPlayer = ({\n  src,\n  playing = false,\n  volume,\n  muted,\n  repeat,\n  setCurrentTime,\n  setDuration,\n  clickedTime,\n  isSeeking,\n  toggleSeeking,\n  toggleSongPlaying,\n  nextSong\n}) => {\n  const audioRef = createRef();\n  const isRendered = useRef(false);\n  useEffect(() => {\n    if (audioRef.current && src) {\n      audioRef.current.src = src;\n    }\n  }, [src]);\n  useEffect(() => {\n    if (isSeeking && audioRef.current && clickedTime !== audioRef.current.currentTime) {\n      toggleSeeking();\n      audioRef.current.currentTime = clickedTime;\n    }\n  }, [clickedTime]);\n  useEffect(() => {\n    if (audioRef.current && (volume || muted)) {\n      audioRef.current.volume = muted ? 0 : volume;\n    }\n  }, [volume, muted]);\n  useEffect(() => {\n    if (isRendered.current && audioRef.current) {\n      if (playing) {\n        audioRef.current.play();\n      } else if (!playing) {\n        audioRef.current.pause();\n      }\n    }\n\n    return () => {\n      var _audioRef$current;\n\n      (_audioRef$current = audioRef.current) === null || _audioRef$current === void 0 ? void 0 : _audioRef$current.pause();\n    };\n  }, [playing, audioRef]);\n  useEffect(() => {\n    isRendered.current = true;\n  }, []);\n  const songEndActions = {\n    [REPEAT_ACTIONS.NONE]: toggleSongPlaying,\n    [REPEAT_ACTIONS.PLAYLIST]: nextSong\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"audio\", {\n    ref: audioRef,\n    loop: repeat === REPEAT_ACTIONS.SONG,\n    onTimeUpdate: event => {\n      if (clickedTime !== event.currentTarget.currentTime) setCurrentTime(event.currentTarget.currentTime);\n    },\n    onCanPlay: e => setDuration(e.currentTarget.duration),\n    onEnded: () => {\n      var _songEndActions$repea;\n\n      return (_songEndActions$repea = songEndActions[repeat]) === null || _songEndActions$repea === void 0 ? void 0 : _songEndActions$repea.call(songEndActions);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }\n  }, src && /*#__PURE__*/React.createElement(\"source\", {\n    src: src,\n    type: \"audio/mpeg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 17\n    }\n  }), \"Audio isn't enabled on this device\"));\n};\n\nconst mapDispatchToProps = {\n  setCurrentTime,\n  setDuration,\n  toggleSeeking,\n  toggleSongPlaying,\n  nextSong\n};\n\nconst mapStateToProps = state => ({\n  currentSongNumber: state.song.currentSong,\n  playing: state.playing,\n  volume: state.volume,\n  muted: state.muted,\n  repeat: state.repeat,\n  clickedTime: state.song.currentTime,\n  isSeeking: state.seeking\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MusicPlayer);","map":{"version":3,"sources":["/Users/moorea6/Synoptic Project/Music-Player/client/src/components/musicPlayer/MusicPlayer.tsx"],"names":["React","createRef","useEffect","useRef","connect","REPEAT_ACTIONS","setCurrentTime","setDuration","toggleSeeking","toggleSongPlaying","nextSong","MusicPlayer","src","playing","volume","muted","repeat","clickedTime","isSeeking","audioRef","isRendered","current","currentTime","play","pause","songEndActions","NONE","PLAYLIST","SONG","event","currentTarget","e","duration","mapDispatchToProps","mapStateToProps","state","currentSongNumber","song","currentSong","seeking"],"mappings":"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","sourcesContent":["import React, { RefObject, createRef, useEffect, useRef } from \"react\";\n\nimport { connect } from \"react-redux\";\nimport {\n  REPEAT_ACTIONS,\n  stateType,\n  setCurrentTime,\n  setDuration,\n  toggleSeeking,\n  toggleSongPlaying,\n  nextSong,\n} from \"../../store/slice\";\nimport {\n  ActionCreatorWithoutPayload,\n  ActionCreatorWithPayload,\n} from \"@reduxjs/toolkit\";\n\ninterface MusicPlayerProps {\n  src?: string;\n  playing?: boolean;\n  volume: number;\n  muted: boolean;\n  repeat: string;\n  isSeeking: boolean;\n  clickedTime: number;\n  setCurrentTime: ActionCreatorWithPayload<number>;\n  setDuration: ActionCreatorWithPayload<number>;\n  toggleSeeking: ActionCreatorWithoutPayload;\n  toggleSongPlaying: ActionCreatorWithoutPayload;\n  nextSong: ActionCreatorWithoutPayload;\n}\n\nconst MusicPlayer = ({\n  src,\n  playing = false,\n  volume,\n  muted,\n  repeat,\n  setCurrentTime,\n  setDuration,\n  clickedTime,\n  isSeeking,\n  toggleSeeking,\n  toggleSongPlaying,\n  nextSong,\n}: MusicPlayerProps) => {\n  const audioRef: RefObject<HTMLAudioElement> = createRef();\n  const isRendered: React.MutableRefObject<boolean> = useRef(false);\n\n  useEffect(() => {\n    if (audioRef.current && src) {\n      audioRef.current.src = src;\n    }\n  }, [src]);\n\n  useEffect(() => {\n    if (\n      isSeeking &&\n      audioRef.current &&\n      clickedTime !== audioRef.current.currentTime\n    ) {\n      toggleSeeking();\n      audioRef.current.currentTime = clickedTime;\n    }\n  }, [clickedTime]);\n\n  useEffect(() => {\n    if (audioRef.current && (volume || muted)) {\n      audioRef.current.volume = muted ? 0 : volume;\n    }\n  }, [volume, muted]);\n\n  useEffect(() => {\n    if (isRendered.current && audioRef.current) {\n      if (playing) {\n        audioRef.current.play();\n      } else if (!playing) {\n        audioRef.current.pause();\n      }\n    }\n    return () => {\n      audioRef.current?.pause();\n    };\n  }, [playing, audioRef]);\n\n  useEffect(() => {\n    isRendered.current = true;\n  }, []);\n\n  const songEndActions = {\n    [REPEAT_ACTIONS.NONE]: toggleSongPlaying,\n    [REPEAT_ACTIONS.PLAYLIST]: nextSong,\n  };\n\n  return (\n    <>\n      <audio\n        ref={audioRef}\n        loop={repeat === REPEAT_ACTIONS.SONG}\n        onTimeUpdate={(event) => {\n          if (clickedTime !== event.currentTarget.currentTime)\n            setCurrentTime(event.currentTarget.currentTime);\n        }}\n        onCanPlay={(e) => setDuration(e.currentTarget.duration)}\n        onEnded={() => songEndActions[repeat]?.()}\n      >\n        {src && <source src={src} type=\"audio/mpeg\" />}\n        Audio isn't enabled on this device\n      </audio>\n    </>\n  );\n};\n\nconst mapDispatchToProps = {\n  setCurrentTime,\n  setDuration,\n  toggleSeeking,\n  toggleSongPlaying,\n  nextSong,\n};\n\nconst mapStateToProps = (state: stateType) => ({\n  currentSongNumber: state.song.currentSong,\n  playing: state.playing,\n  volume: state.volume,\n  muted: state.muted,\n  repeat: state.repeat,\n  clickedTime: state.song.currentTime,\n  isSeeking: state.seeking,\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MusicPlayer);\n"]},"metadata":{},"sourceType":"module"}